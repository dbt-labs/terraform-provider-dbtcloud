# Changelog
All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html),
and is generated by [Changie](https://github.com/miniscruff/changie).


## [Unreleased]

### Fixes
* Fixed bug where disabling `on_merge` trigger on merge jobs incorrectly forced resource replacement instead of updating in-place. Merge jobs can now be deactivated by setting `triggers.on_merge = false` without recreation. The provider no longer infers job type changes from trigger values.
* Fixed bug where `cost_optimization_features` was missing from `dbtcloud_job` and `dbtcloud_jobs` data sources. The field was present in the model but not exposed in the schema or populated in the Read methods.

### Documentation
* Added documentation clarifying job type behavior, trigger deactivation, and which changes require resource replacement vs in-place updates. Includes a table showing which job types can be deactivated in-place and which job type transitions are allowed.

### Testing
* Added acceptance test `TestAccDbtCloudJobResourceMergeTriggerDisable` to verify merge jobs can have their `on_merge` trigger toggled without resource replacement.
* Added acceptance test `TestAccDbtCloudJobResourceScheduledToOther` to verify scheduled jobs can transition to 'other' job_type and back in-place.
* Added acceptance test `TestAccDbtCloudJobResourceScheduledWithSAO` to verify scheduled jobs work correctly with `run_compare_changes` (SAO) and `deferring_environment_id`.
* Added acceptance test `TestAccDbtCloudJobResourceCompareChangesFlagsCustomSelector` to verify custom `compare_changes_flags` selectors work correctly.

# [v1.6.0](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.5.1...v1.6.0)
### Changes
* Added `cost_optimization_features` attribute to `dbtcloud_job` resource for controlling State-Aware Orchestration (SAO). This is the preferred way to control SAO features; use this instead of `force_node_selection`.
* Deprecated `force_node_selection` in favor of `cost_optimization_features`. The attribute will be removed in a future major version.

### Fixes
* Fixed bug where `deferring_environment_id` was incorrectly dropped for CI and Merge jobs, preventing deferral from working on these job types.
* Fixed bug where CI and Merge jobs would fail with "State aware orchestration is not available for CI or Merge jobs" error when `force_node_selection` was implicitly set. The provider now correctly handles both null and unknown values, omitting the field entirely for new resources and CI/Merge jobs.

### Testing
* Added acceptance tests for CI/Merge jobs with explicit `force_node_selection = null` to ensure the fix for the IsUnknown() bug is covered by tests. This catches the specific scenario where Terraform modules pass null values.

### Documentation
* Updated `dbtcloud_job` documentation with comprehensive SAO (State-Aware Orchestration) guidance including:
  - Clear explanation of `force_node_selection` rules for different job types
  - Migration guide from `force_node_selection` to `cost_optimization_features`
  - Clarified that CI/Merge jobs CAN have `deferring_environment_id` for artifact deferral

# [v1.5.1](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.5.0...v1.5.1)
### Fixes
* Fix for issue 582
* Allow rename of env without re-create
* Return if a partial group permission delete fails
* Fixed updating environment with eats removed
### Behind the scenes
* Custom branch and use custom branch must match

# [v1.5.0](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.4.2...v1.5.0)
### Changes
* Configurable timeout for provider client
* Added validation for Job execution steps
* Added missing permissions to permission set
### Fixes
* SSH Tunnel flag correctly set for Postgres and Redshift connections
* Lingering group deleted if permissions update fails
### Behind the scenes
* Security patch
* Fixed User Datasource test

# [v1.4.2](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.4.1...v1.4.2)
### Changes
* Added skip_credentials_validation flag to provider for skipping credential validation during initialization
* Add validation to schema names to follow the same rules as in the cloud UI
* Job is_active field enforced to be true on resource creation
### Behind the scenes
* Security update
* Null id validation

# [v1.4.1](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.4.0...v1.4.1)

# [v1.4.0](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.3.0...v1.4.0)
### Changes
* Add new `dbtcloud_scim_group_partial_permissions` resource for federated permission management.
This resource enables multiple Terraform workspaces to manage different permissions for the same
externally-managed group (e.g., SCIM-synced groups). Platform teams can manage base permissions
while individual teams manage project-specific permissions independently.

* Validation for athena s3 path
* Add spark credential
* Add force_node_selection for SAO
* Added new `dbtcloud_spark_credential` resource and data source for managing Apache Spark credentials.
This enables users to create and manage Apache Spark credentials separately from Databricks credentials,
providing proper support for Apache Spark connections with the correct adapter version (apache_spark_v0).

### Fixes
* Fixed panic crash when attempting to move jobs to environments with insufficient permissions. 
Added nil pointer checks in job creation, enhanced API error handling for 401/403/404 permission errors,
and improved error messages to show attempted changes with environment-specific guidance.
Fixed DELETE 404 handling to treat already-deleted resources as success.

### Behind the scenes
* Fixes to E2E tests
* Test job for issue 516
### Documentation
* Improved CredentialID description on Environment resource

# [v1.3.0](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.2.2...v1.3.0)
### Changes
* Added support vor bq adapter v1
### Fixes
* Resolved `dbtcloud_privatelink_endpoint` limitation to support filtering across all paginated endpoints, not just the first 100.
* Resolved `dbtcloud_privatelink_endpoints` not working with the legacy resource names.
* 
### Documentation
* Added documentation and examples for the `dbtcloud_privatelink_endpoints` data source.

# [v1.2.2](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.2.1...v1.2.2)
### Changes
* Added resource to get all privatelink endpoint urls
* Create dbtcloud_scim_group_permissions and groups data source
### Fixes
* Keep private key on update on bq sl cred
### Documentation
* Added clarification on ADO repository docs for required fields
# [v1.2.1](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.2.0...v1.2.1)
### Changes
* Added resource to get all privatelink endpoint urls
* Added ci / cd job to run tf
* Create dbtcloud_scim_group_permissions and groups data source
### Fixes
* Fixed dbt version in gh action
* Keep private key on update on bq sl cred
### Documentation
* Added clarification on ADO repository docs for required fields

# [v1.2.0](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.1.4...v1.2.0)
### Changes
* Added configurations for retry mechanism
* Make all dbt cloud methods use retries
### Fixes
* Removed omitempty from the bool property Active, as this creates an unexpected behavior when json marshalling is done. False values are seen as 0
* Fix postgres credential update failures due to incorrect ID usage
* Handle 400s
* Remove log that fails when project not allowed
* BQ SL credential check for private key null
### Documentation
* Doc updates

# [v1.1.4](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.1.3...v1.1.4)
### Changes
* Add support for private link endpoint on the repository resource
* Support for 'latest-fusion' and minor dbt versions
* Allow compatible and extended as dbt_version on Environment resources
### Fixes
* Resolved nil pointer dereference panic when reading project.DbtProjectSubdirectory within the project.data_source by utilizing safe string conversion
* Revert change that removed 'required replace' property on repository id to recreate the project repository
* Allow empty string as Project subdirectory
### Documentation
* Updated Notification docs to clarify User ID usage

# [v1.1.3](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.1.2...v1.1.3)
### Fixes
* Fixed Missing Required Attribute Issue Caused by SemanticLayerCredentialValidator
* Fix update on the repository resource after the resource is imported.

# [v1.1.2](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.1.1...v1.1.2)
### Changes
* Adds new resource: semantic_layer_credential_service_token_mapping
* Created Semantic Layer Credential resource for Databricks and also did a minor refactoring
* Added semantic layer credential resource for Postgres
### Fixes
* Fixes orphaned semantic layer configuration not showing up in project
* Add fix for Branch link in IDE redirects to https://github.com/None/tree/main on projects that were created with terraform
### Behind the scenes
* Allow Changie check to account for fork PRs

# [v1.1.1](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.1.0...v1.1.1)
### Changes
* Minor redshift sl credential refactoring. Code review comments solving for PR #451
### Fixes
* Fixed default parameter for Redshift leveraging of Postgres Credential
* Fixed recreation prompt for Azure AD repositories

# [v1.1.0](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v1.0.0...v1.1.0)
### Changes
* Implemented BigQuery for Semantic Layer Credentials
* Implemented Redshift for Semantic Layer Credentials
* Added support for Synapse Credential
### Fixes
* Obfuscate error messages from the API that would display the token
* Fixed issue with environment optional parameters being seen as null instead of being disregarded
* Fix repository create and apply to be consistent with multiple applies. Issue #433
### Behind the scenes
* Deparallelized flaky test
### Documentation
* Added changie for CHANGELOG management

# [1.0.0](https://github.com/dbt-labs/terraform-provider-dbtcloud/compare/v0.0.0...1.0.0)
